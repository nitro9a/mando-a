#: import NoTransition kivy.uix.screenmanager.NoTransition

#: set white (1, 1, 1, 1)
#: set black (0, 0, 0, 1)
#: set yellow (.9, .8, 0, 1)
#: set red (.9, .3, 0, 1)
#: set orange (.9, .5, 0, 1)

<ScaleButton>:
    size_hint: .2, .05
    color: white
    background_normal: ''
    background_color: (155/255., 155/255., 155/255., 1)
    allow_stretch: False
    keep_ratio: True
<ScaleLabel>:
    size_hint: .5, .5
    pos_hint: {'top': .65, 'center_x': .5}
    color: (0/255., 0/255., 0/255., 1)
    background_normal: ''
    bcolor: (155/255., 155/255., 155/255., 1)
    allow_stretch: False
    keep_ratio: True
<ScrollableLabel>:
    bcolor: (155/255., 155/255., 155/255., 1)
    color: (0/255., 0/255., 0/255., 1)
<SelectableButton>:
    color: (0/255., 255/255., 0/255., 1)
    background_color: (0/255., 155/255., 155/255., 1)

<RV>:
    viewclass: 'SelectableButton'
    RecycleBoxLayout:
        bcolor: 1,1,1,1
        padding: "15dp", "5dp", "15dp", "15dp"
        default_size: None, dp(25)
        default_size_hint: 1, None
        size_hint_y: None
        height: self.minimum_height
        orientation: 'vertical'

<-SelectableButton>:
    state_image: self.background_normal if self.state == 'normal' else self.background_down
	disabled_image: self.background_disabled_normal if self.state == 'normal' else self.background_disabled_down
	_scale: 1. if self.texture_size[0] < self.width else float(self.width - 10) / (self.texture_size[0] + .001)
	orientation: 'horizontal'
    # Draw a background to indicate selection
    canvas.before:
        Color:
            rgba: self.background_color
        BorderImage:
            border: self.border
            pos: self.pos
            size: self.size
            source: self.disabled_image if self.disabled else self.state_image
        PushMatrix
        Scale:
            origin: self.center
            x: self._scale or 1.
            y: self._scale or 1.
        Color:
            rgba: self.disabled_color if self.disabled else self.color
        Rectangle:
            texture: self.texture
            size: self.texture_size
            pos: int(self.center_x - self.texture_size[0] / 2.), int(self.center_y - self.texture_size[1] / 2.)
        PopMatrix

<MessageBox>:
    name: 'mbox'
    lbl: lbl
    btn: btn
    title: ''
    separator_height: 0
    size_hint: .75, .75
    size: 400, 400
    on_dismiss: root.clear()

    GridLayout:
        orientation: 'horizontal'
        cols: 1
        rows: 3
        spacing: 10
        padding: 10

        GridLayout:
            orientation: 'horizontal'
            cols: 1
            rows: 1
            spacing: 10
            padding: 10
            size_hint_y: 60

            ScrollableLabel:
                id: lbl
                text: root.obj_text
                size_hint_y: None
                text_size: self.width, None
                height: self.texture_size[1]

        GridLayout:
            orientation: 'horizontal'
            cols: 1
            rows: 1
            spacing: 10
            padding: 10
            size_hint_y: 20

            ScaleButton:
                id: btn
                text: "  Add to Favorites?"
                size_hint_y: 25
                text_size: self.width, None
                height: self.texture_size[1]
                on_press: root.add_to_favorites()
                on_release: app.root.get_screen('favorites').display_database()

        GridLayout:
            orientation: 'horizontal'
            cols: 1
            rows: 1
            spacing: 10
            padding: 10
            size_hint_y: 20

            ScaleButton:
                orientation: 'vertical'
                size_hint: .2, .2
                text: 'OK'
                on_press:
                    root.dismiss()

<MessageBoxRead>:
    name: 'mboxr'
    lbl: lbl
    btn: btn
    title: ''
    separator_height: 0
    size_hint: .75, .75
    size: 400, 400
    on_dismiss: root.clear()

    GridLayout:
        orientation: 'horizontal'
        cols: 1
        rows: 3
        spacing: 10
        padding: 10

        GridLayout:
            orientation: 'horizontal'
            cols: 1
            rows: 1
            spacing: 10
            padding: 10
            size_hint_y: 60

            ScaleLabel:
                id: lbl
                text: root.obj_text
                size_hint_y: None
                text_size: self.width, None
                height: self.texture_size[1]

        GridLayout:
            orientation: 'horizontal'
            cols: 1
            rows: 1
            spacing: 10
            padding: 10
            size_hint_y: 20

            ScaleButton:
                id: btn
                text: "  Add to Favorites?"
                size_hint_y: 25
                text_size: self.width, None
                height: self.texture_size[1]
                on_press: root.add_to_favorites()
                on_release: app.root.get_screen('favorites').display_database()

        GridLayout:
            orientation: 'horizontal'
            cols: 1
            rows: 1
            spacing: 10
            padding: 10
            size_hint_y: 20

            ScaleButton:
                orientation: 'vertical'
                size_hint: .2, .2
                text: 'OK'
                on_press:
                    root.dismiss()

<MessageBoxFavorites>:
    name: 'mboxfav'
    lbl: lbl
    btn: btn
    title: ''
    separator_height: 0
    size_hint: .75, .75
    on_dismiss: root.clear()

    GridLayout:
        orientation: 'horizontal'
        cols: 1
        rows: 3
        spacing: 10
        padding: 10

        GridLayout:
            orientation: 'horizontal'
            cols: 1
            rows: 1
            spacing: 10
            padding: 10
            size_hint_y: 60

            ScaleLabel:
                id: lbl
                text: root.obj_text
                size_hint_y: None
                text_size: self.width, None
                height: self.texture_size[1]

        GridLayout:
            orientation: 'horizontal'
            cols: 1
            rows: 1
            spacing: 10
            padding: 10
            size_hint_y: 20

            ScaleButton:
                id: btn
                text: "  Remove from Favorites?"
                size_hint_y: 25
                text_size: self.width, None
                height: self.texture_size[1]
                on_press:
                    root.remove_from_favorites()
                on_release:
                    app.root.get_screen('favorites').display_database()

        GridLayout:
            orientation: 'horizontal'
            cols: 1
            rows: 1
            spacing: 10
            padding: 10
            size_hint_y: 20

            ScaleButton:
                orientation: 'vertical'
                size_hint: .2, .2
                text: 'OK'
                on_press:
                    root.dismiss()

<MessageBoxFinished>:
    name: 'mboxfin'
    lbl: lbl
    yes: yes
    no: no
    title: ''
    separator_height: 0
    size_hint: .75, .75
    size: 400, 400

    GridLayout:
        orientation: 'horizontal'
        cols: 1
        rows: 4
        spacing: 10
        padding: 10

        GridLayout:
            orientation: 'horizontal'
            cols: 1
            rows: 1
            spacing: 10
            padding: 10
            size_hint_y: 25

            ScaleLabel:
                id: lbl
                text: "You have been through the entire dictionary.  Would you like to reset it?"
                halign: "center"
                size_hint_y: None
                text_size: self.width, None
                height: self.texture_size[1]

        GridLayout:
            orientation: 'horizontal'
            cols: 1
            rows: 2
            spacing: 30
            padding: 30
            size_hint_y: 50

            ScaleButton:
                id: yes
                orientation: 'horizontal'
                size_hint: .2, .2
                text: 'Yes'
                on_press:
                    root.reset_databases()
                on_release:
                    app.root.get_screen('read').display_database()
                    app.root.get_screen('unread').display_database()
                    root.dismiss()

            ScaleButton:
                id: no
                orientation: 'horizontal'
                size_hint: .2, .2
                text: 'No'
                on_press:
                    root.dismiss()

<MessageBoxConfirmation>:
    name: 'mboxc'
    lbl: lbl
    yes: yes
    no: no
    title: ''
    separator_height: 0
    size_hint: .75, .75
    size: 400, 400

    GridLayout:
        orientation: 'horizontal'
        cols: 1
        rows: 4
        spacing: 10
        padding: 10

        GridLayout:
            orientation: 'horizontal'
            cols: 1
            rows: 1
            spacing: 10
            padding: 10
            size_hint_y: 25

            ScaleLabel:
                id: lbl
                text: "Reset Dictionaries?"
                halign: "center"
                size_hint_y: None
                text_size: self.width, None
                height: self.texture_size[1]

        GridLayout:
            orientation: 'horizontal'
            cols: 1
            rows: 2
            spacing: 30
            padding: 30
            size_hint_y: 50

            ScaleButton:
                id: yes
                orientation: 'horizontal'
                size_hint: .2, .2
                text: 'Yes'
                on_press:
                    root.reset_databases()
                on_release:
                    app.root.get_screen('unread').display_database()
                    app.root.get_screen('read').display_database()
                    root.dismiss()

            ScaleButton:
                id: no
                orientation: 'horizontal'
                size_hint: .2, .2
                text: 'No'
                on_press:
                    root.dismiss()

<MessageBoxFavoritesConfirmation>:
    name: 'mboxcf'
    lbl: lbl
    yes: yes
    no: no
    title: ''
    separator_height: 0
    size_hint: .75, .75
    size: 400, 400

    GridLayout:
        orientation: 'horizontal'
        cols: 1
        rows: 4
        spacing: 10
        padding: 10

        GridLayout:
            orientation: 'horizontal'
            cols: 1
            rows: 1
            spacing: 10
            padding: 10
            size_hint_y: 25

            ScaleLabel:
                id: lbl
                text: "Reset Favorites?"
                halign: "center"
                size_hint_y: None
                text_size: self.width, None
                height: self.texture_size[1]

        GridLayout:
            orientation: 'horizontal'
            cols: 1
            rows: 2
            spacing: 30
            padding: 30
            size_hint_y: 50

            ScaleButton:
                id: yes
                orientation: 'horizontal'
                size_hint: .2, .2
                text: 'Yes'
                on_press:
                    root.reset_favorites()
                on_release:
                    app.root.get_screen('favorites').display_database()
                    root.dismiss()

            ScaleButton:
                id: no
                orientation: 'horizontal'
                size_hint: .2, .2
                text: 'No'
                on_press:
                    root.dismiss()

WindowManager:

    transition: NoTransition()
    WordADay:
    UnreadWords:
    ReadWords:
    Favorites:


<WordADay>:
    name: "word"
    get: get
    translation: translation

    #on_leave:
        #root.manager.get_screen('favorites').display_database()
        #root.manager.get_screen('unread').display_database()
        #root.manager.get_screen('read').display_database()

    BoxLayout:
        spacing: 10
        padding: 10
        orientation: "vertical"
        rows: 4
        cols: 1

        GridLayout:
            cols: 4
            rows: 1
            spacing: 0
            size_hint_y: 5

            ScaleButton:
                id: page1
                text: "Page 1"
                on_press:
                    app.root.current = "word"

            ScaleButton:
                id: page2
                text: "Page 2"
                on_press:
                    app.root.current = "unread"
                on_release:
                    root.manager.get_screen('unread').display_database()

            ScaleButton:
                id: page3
                text: "Page 3"
                on_press:
                    app.root.current = "read"
                on_release:
                    root.manager.get_screen('read').display_database()

            ScaleButton:
                id: page4
                text: "Page 4"
                on_press:
                    app.root.current = "favorites"
                on_release:
                    root.manager.get_screen('favorites').display_database()

        GridLayout:
            cols: 1
            rows: 1
            spacing: 10
            size_hint_y: 15

            ScaleButton:
                id: get
                text: "Get a Word"
                pos_hint: {'top': .85, 'center_x': .5}

                on_press:
                    root.random_word()
                    root.ids.btn.text = "    Add to favorites?"
                #on_release:
                    #app.root.get_screen('unread').display_database()
                    #root.manager.get_screen('read').display_database()

        GridLayout:
            cols: 1
            rows: 1
            spacing: 10
            size_hint_y: 70

            ScaleLabel:
                id: translation
                text: ""
                pos_hint: {'top': .65, 'center_x': .5}
                size_hint: .7, .5
                font_size: 75
                valign: 'top'
                halign: 'center'
                text_size: self.size
                height: self.texture_size[1]

        GridLayout:
            cols: 1
            rows: 1
            spacing: 10
            size_hint_y: 10

            GridLayout:
                orientation: 'horizontal'
                cols: 1
                rows: 1
                spacing: 10
                padding: 10

                ScaleButton:
                    id: btn
                    text: ""
                    text_size: self.size
                    valign: 'middle'
                    halign: 'center'
                    on_press: root.add_to_favorites()
                    on_release: app.root.get_screen('favorites').display_database()

<UnreadWords>:
    name: "unread"
    reset: reset
    unread_table: unread_table

    BoxLayout:
        spacing: 10
        padding: 10
        orientation: "vertical"
        rows: 4
        cols: 1

        GridLayout:
            cols: 4
            rows: 1
            spacing: 0
            size_hint_y: 5

            ScaleButton:
                id: page1
                text: "Page 1"
                on_press:
                    app.root.current = "word"

            ScaleButton:
                id: page2
                text: "Page 2"
                on_press:
                    app.root.current = "unread"
                on_release:
                    root.display_database()

            ScaleButton:
                id: page3
                text: "Page 3"
                on_press:
                    app.root.current = "read"
                on_release:
                    root.manager.get_screen('read').display_database()

            ScaleButton:
                id: page4
                text: "Page 4"
                on_press:
                    app.root.current = "favorites"
                on_release:
                    root.manager.get_screen('favorites').display_database()

        GridLayout:
            cols: 4
            rows: 1
            spacing: 0
            size_hint_y: 5

            ScaleLabel:
                text: "Unread Words"
                size_hint_y: 5

        GridLayout:
            cols: 1
            rows: 1
            spacing: 0
            size_hint_y: 80

            BoxLayout:
                id: unread_table
                RV:
                    id: dat
                    viewclass: 'SelectableButtonUnread'
                    size_hint_y: 1
                    font_size: self.height * 0.5

        GridLayout:
            cols: 2
            rows: 1
            spacing: 0
            size_hint_y: 10

            ScaleButton:
                id: reset
                text: "Reset Dictionaries"
                pos_hint: {'top': .85, 'center_x': .5}
                on_press:
                    root.confirmation_popup()
                    root.manager.get_screen('word').ids.translation.text = ""
                    root.manager.get_screen('word').ids.btn.text = ""
                    root.display_database()

<ReadWords>:
    name: "read"
    reset: reset
    read_table: read_table

    BoxLayout:
        spacing: 10
        padding: 10
        orientation: "vertical"
        rows: 4
        cols: 1

        GridLayout:
            cols: 4
            rows: 1
            spacing: 0
            size_hint_y: 5

            ScaleButton:
                id: page1
                text: "Page 1"
                on_press:
                    app.root.current = "word"

            ScaleButton:
                id: page2
                text: "Page 2"
                on_press:
                    app.root.current = "unread"
                on_release:
                    root.manager.get_screen('unread').display_database()

            ScaleButton:
                id: page3
                text: "Page 3"
                on_press:
                    app.root.current = "read"
                on_release:
                    root.display_database()

            ScaleButton:
                id: page4
                text: "Page 4"
                on_press:
                    app.root.current = "favorites"
                on_release:
                    root.manager.get_screen('favorites').display_database()

        GridLayout:
            cols: 4
            rows: 1
            spacing: 0
            size_hint_y: 5

            ScaleLabel:
                text: "Read Words"
                size_hint_y: 5

        GridLayout:
            cols: 1
            rows: 1
            spacing: 0
            size_hint_y: 80

            BoxLayout:
                id: read_table
                RV:
                    id: dat
                    viewclass: 'SelectableButtonRead'
                    size_hint_y: 1
                    font_size: self.height * 0.5

        GridLayout:
            cols: 2
            rows: 1
            spacing: 0
            size_hint_y: 10

            ScaleButton:
                id: reset
                text: "Reset Dictionaries"
                pos_hint: {'top': .85, 'center_x': .5}
                on_press:
                    root.confirmation_popup()
                    root.manager.get_screen('word').ids.translation.text = ""
                    root.manager.get_screen('word').ids.btn.text = ""
                    root.display_database()

<Favorites>:
    name: "favorites"
    favorites_table: favorites_table

    BoxLayout:
        spacing: 10
        padding: 10
        orientation: "vertical"
        rows: 4
        cols: 1

    BoxLayout:
        spacing: 10
        padding: 10
        orientation: "vertical"
        rows: 4
        cols: 1

        GridLayout:
            cols: 4
            rows: 1
            spacing: 0
            size_hint_y: 5

            ScaleButton:
                id: page1
                text: "Page 1"
                on_press:
                    app.root.current = "word"

            ScaleButton:
                id: page2
                text: "Page 2"
                on_press:
                    root.manager.get_screen('unread').display_database()
                on_release:
                    app.root.current = "unread"

            ScaleButton:
                id: page3
                text: "Page 3"
                on_press:
                    app.root.current = "read"
                on_release:
                    root.manager.get_screen('read').display_database()

            ScaleButton:
                id: page4
                text: "Page 4"
                on_press:
                    app.root.current = "favorites"
                on_release:
                    root.display_database()

        GridLayout:
            cols: 4
            rows: 1
            spacing: 0
            size_hint_y: 5

            ScaleLabel:
                text: "Favorites"
                size_hint_y: 5

        GridLayout:
            cols: 1
            rows: 1
            spacing: 0
            size_hint_y: 80

            BoxLayout:
                id: favorites_table
                RV:
                    id: dat
                    viewclass: 'SelectableButtonFavorites'
                    size_hint_y: 1
                    font_size: self.height * 0.5

        GridLayout:
            cols: 2
            rows: 1
            spacing: 0
            size_hint_y: 10

            ScaleButton:
                id: reset
                text: "Reset Favorites"
                pos_hint: {'top': .85, 'center_x': .5}
                on_press:
                    root.confirmation_popup()
                on_release:
                    root.display_database()




